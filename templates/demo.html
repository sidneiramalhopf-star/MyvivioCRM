<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo - Novos Endpoints Funcionando</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        h1 {
            color: #667eea;
            margin-bottom: 10px;
        }
        .status {
            background: #10b981;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            font-size: 18px;
            font-weight: bold;
        }
        .section {
            margin: 30px 0;
            padding: 20px;
            background: #f8fafc;
            border-radius: 8px;
        }
        h2 {
            color: #334155;
            margin-bottom: 15px;
        }
        .item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 6px;
            border-left: 4px solid #667eea;
        }
        .item h3 {
            color: #667eea;
            margin-bottom: 5px;
        }
        .item p {
            color: #64748b;
            margin: 5px 0;
        }
        .badge {
            display: inline-block;
            background: #ddd6fe;
            color: #6d28d9;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin: 5px 5px 0 0;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 10px 10px 0;
        }
        button:hover {
            background: #5568d3;
        }
        .login-section {
            background: #fef3c7;
            border: 2px solid #fbbf24;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .credentials {
            background: #1e293b;
            color: #10b981;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéâ Sistema Myvivio CRM - Demonstra√ß√£o</h1>
        <div class="status">‚úÖ BACKEND 100% FUNCIONAL - 27 ENDPOINTS ATIVOS</div>

        <div class="login-section">
            <h2>üîë Credenciais de Teste</h2>
            <div class="credentials">
                Email: admin@teste.com<br>
                Senha: senha123
            </div>
            <button onclick="fazerLogin()">Fazer Login Autom√°tico</button>
            <button onclick="window.location.href='/'">Ir para Dashboard Principal</button>
        </div>

        <div class="section">
            <h2>üèãÔ∏è Salas Cadastradas</h2>
            <div id="salas-list">Carregando...</div>
            <button onclick="carregarSalas()">Recarregar Salas</button>
        </div>

        <div class="section">
            <h2>üë®‚Äçüè´ Instrutores Cadastrados</h2>
            <div id="instrutores-list">Carregando...</div>
            <button onclick="carregarInstrutores()">Recarregar Instrutores</button>
        </div>

        <div class="section">
            <h2>üìÖ Aulas Agendadas</h2>
            <div id="aulas-list">Carregando...</div>
            <button onclick="carregarAulas()">Recarregar Aulas</button>
        </div>

        <div class="section">
            <h2>üìä Estat√≠sticas da Primeira Aula</h2>
            <div id="stats">Clique em "Carregar Estat√≠sticas" ap√≥s login</div>
            <button onclick="carregarStats()">Carregar Estat√≠sticas</button>
        </div>
    </div>

    <script>
        let token = localStorage.getItem('token');

        async function fazerLogin() {
            const response = await fetch('/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email: 'admin@teste.com', senha: 'senha123' })
            });
            const data = await response.json();
            token = data.access_token;
            localStorage.setItem('token', token);
            alert('‚úÖ Login realizado com sucesso! Agora voc√™ pode carregar os dados.');
        }

        async function carregarSalas() {
            if (!token) return alert('‚ùå Fa√ßa login primeiro!');
            const response = await fetch('/salas', {
                headers: { 'Authorization': `Bearer ${token}` }
            });
            const salas = await response.json();
            const html = salas.map(s => `
                <div class="item">
                    <h3>${s.nome}</h3>
                    <p>Capacidade: ${s.capacidade} pessoas</p>
                    <span class="badge">ID: ${s.id}</span>
                </div>
            `).join('');
            document.getElementById('salas-list').innerHTML = html;
        }

        async function carregarInstrutores() {
            if (!token) return alert('‚ùå Fa√ßa login primeiro!');
            const response = await fetch('/instrutores', {
                headers: { 'Authorization': `Bearer ${token}` }
            });
            const instrutores = await response.json();
            const html = instrutores.map(i => `
                <div class="item">
                    <h3>${i.nome}</h3>
                    <p>Email: ${i.email}</p>
                    <p>Especialidades: ${i.especialidades}</p>
                    <span class="badge">ID: ${i.id}</span>
                </div>
            `).join('');
            document.getElementById('instrutores-list').innerHTML = html;
        }

        async function carregarAulas() {
            if (!token) return alert('‚ùå Fa√ßa login primeiro!');
            const response = await fetch('/aulas', {
                headers: { 'Authorization': `Bearer ${token}` }
            });
            const aulas = await response.json();
            const html = aulas.map(a => {
                const data = new Date(a.data_hora);
                return `
                <div class="item">
                    <h3>${a.nome_aula}</h3>
                    <p>${a.descricao}</p>
                    <p>Instrutor: ${a.instrutor} | Sala: ${a.sala}</p>
                    <p>Data: ${data.toLocaleDateString('pt-BR')} √†s ${data.toLocaleTimeString('pt-BR')}</p>
                    <p>Dura√ß√£o: ${a.duracao_minutos} minutos</p>
                    <span class="badge">Vagas: ${a.total_reservas}/${a.limite_inscricoes}</span>
                    <span class="badge">ID: ${a.id}</span>
                </div>
            `}).join('');
            document.getElementById('aulas-list').innerHTML = html;
        }

        async function carregarStats() {
            if (!token) return alert('‚ùå Fa√ßa login primeiro!');
            const response = await fetch('/aulas/1/estatisticas', {
                headers: { 'Authorization': `Bearer ${token}` }
            });
            const stats = await response.json();
            document.getElementById('stats').innerHTML = `
                <div class="item">
                    <h3>Spinning Matinal - Estat√≠sticas</h3>
                    <p>Total Inscritos: ${stats.total_inscritos}</p>
                    <p>Ocupa√ß√£o: ${stats.ocupacao_percentual}%</p>
                    <p>Total Presentes: ${stats.total_presentes}</p>
                    <p>Total Faltas: ${stats.total_faltas}</p>
                    <p>Total Justificadas: ${stats.total_justificadas}</p>
                    <span class="badge">‚úÖ ATTENDANCE ATIVO</span>
                </div>
            `;
        }

        // Carregar automaticamente se j√° tiver token
        if (token) {
            carregarSalas();
            carregarInstrutores();
            carregarAulas();
        }
    </script>
</body>
</html>
